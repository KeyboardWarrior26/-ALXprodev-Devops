#!/bin/bash

# File with list of Pokémon names (e.g., pikachu, bulbasaur, etc.)
input_file="pokemon_list.txt"
log_file="errors.log"

# Ensure log file is empty before new run
> "$log_file"

# Loop through each Pokémon name in the file
while read -r name; do
    attempts=0
    success=0

    while [ $attempts -lt 3 ]; do
        response=$(curl -s -w "%{http_code}" "https://pokeapi.co/api/v2/pokemon/$name" -o response.json)
        http_code="${response: -3}"

        if [ "$http_code" = "200" ]; then
            # Extract and format the Pokémon data
            pname=$(jq -r '.name' response.json | sed 's/.*/\u&/')
            ptype=$(jq -r '.types[0].type.name' response.json | sed 's/.*/\u&/')
            weight=$(jq '.weight' response.json | awk '{printf "%.1f", $1/10}')
            height=$(jq '.height' response.json | awk '{printf "%.1f", $1/10}')

            echo "$pname is of type $ptype, weighs ${weight}kg, and is ${height}m tall."
            success=1
            break
        else
            ((attempts++))
            sleep 1  # wait before retrying
        fi
    done

    if [ $success -eq 0 ]; then
        echo "Failed to fetch data for $name after 3 attempts." >> "$log_file"
    fi
done < "$input_file"

